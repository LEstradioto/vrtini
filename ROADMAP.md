# Roadmap — Visual Diff Intelligence

## Vision

Build a best‑in‑class visual regression platform that explains _what changed_ and _why_, not just where pixels differ. The system should classify changes (text, layout, spacing, style, background) and produce a natural‑language report that is useful for humans and AI‑assisted fixes.

## Nice to have

- Do your usual visual regression testing with vrtini.
- Enable AI analysis with structured insights and natural‑language summaries.
- Send the best Prompt generated by our tool to send to your AI pair programmer (Claude or Codex...) to match the required design, using the already design system you have.
- So from Figma, reference Image or URLs, you could generate a PRD to produce a new page or component matching the current design system.

## Now (Near‑Term)

- [ ] Define a first‑class “analysis report” format for each comparison (JSON + human‑readable summary).
- [ ] Add DOM snapshot capture to comparisons (layout boxes + computed styles + text boxes).
- [ ] Add text diff (content and position) and layout drift diff (box movement + size changes).
- [ ] Add a lightweight classification layer: text change, layout shift, spacing change, style change, background change.
- [ ] Ship a report view that shows per‑item insights alongside the visual diff.

## Analysis Pipeline (Spec v1)

- Inputs: baseline image, test image, DOM snapshot (layout + styles + text boxes).
- Visual metrics: pixel diff map + perceptual score (LPIPS/DISTS/FLIP to be chosen).
- Text diff: normalized text content comparison + text box movement detection.
- Layout diff: element bounding box deltas (x/y/width/height) and parent‑child spacing deltas.
- Style diff: computed style changes (background, border, color, font metrics).
- Classification rules: map changes to “content”, “layout”, “spacing”, “style”, “background”.
- Output: per‑item findings with severity and a short explanation.

## Diff Studio (Front‑End Tool)

- [ ] A UI where users provide a URL or image and compare against another URL or image.
- [ ] One‑click snapshot capture (local dev targets like `localhost` supported).
- [ ] Visual diff + structured analysis + natural‑language report.
- [ ] “Comment” workflow: generate a shareable report link with insights and suggested fixes.
- [ ] AI summary that explains changes in human terms, grounded in deterministic metrics.

## Component Atlas (Design System Extraction)

- [ ] Crawl the app and extract reusable UI components as images.
- [ ] If Storybook exists, capture and index all stories automatically.
- [ ] Cluster and label components into a “component atlas” (storybook‑like catalog).
- [ ] Store reference renders to enable component‑level diffs.
- [ ] When a Figma design is provided, map components to known references for faster implementation guidance.

## AI‑Assisted Fix Suggestions

- [ ] Use analysis report + component atlas to generate targeted suggestions (“card padding increased by 6px”).
- [ ] Provide fix hints as structured diffs (CSS/spacing changes) alongside natural language.
- [ ] Keep pass/fail gating deterministic; AI only summarizes and proposes fixes.

## Later / Stretch

- [ ] Multi‑browser normalization heuristics (font metrics, subpixel rounding, rendering differences).
- [ ] Per‑component tolerance thresholds (e.g., “button label kerning acceptable”).
- [ ] Explainability heatmaps for layout vs style vs content changes.
